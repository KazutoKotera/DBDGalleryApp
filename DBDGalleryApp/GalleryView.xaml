<UserControl x:Class="DBDGalleryApp.GalleryView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="37*"/>
            <ColumnDefinition Width="108*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <!-- 上の操作バー（後で検索欄などを追加する場所） -->
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <!-- ギャラリー＋左右ボタン -->
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 上の操作エリア -->
        <Grid Grid.Row="0" Grid.ColumnSpan="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <!-- 戻る -->
                <ColumnDefinition Width="*"/>
                <!-- スペース -->
                <ColumnDefinition Width="Auto"/>
                <!-- S -->
                <ColumnDefinition Width="Auto"/>
                <!-- K -->
            </Grid.ColumnDefinitions>

            <!-- 戻る -->
            <Button Content="戻る" Click="Back_Click"
                    Grid.Column="0" Margin="10,10"/>

            <!-- S ボタン -->
            <Button x:Name="BtnShowS"
                    Content="S"
                    Width="150" Height="30"
                    Margin="5,5,0,5"
                    Grid.Column="2"
                    Click="BtnShowS_Click"/>

            <!-- K ボタン -->
            <Button x:Name="BtnShowK"
                    Content="K"
                    Width="150" Height="30"
                    Margin="0,5,5,5"
                    Grid.Column="3"
                    Click="BtnShowK_Click"/>

        </Grid>

        <Grid Grid.Row="1" Grid.ColumnSpan="2">

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Border x:Name="TagSearchBox"
                    Background="White"
                    BorderBrush="Black"
                    BorderThickness="1"
                    CornerRadius="6"
                    Margin="10"
                    Padding="8"
                    Height="40"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Top"
                    MouseLeftButtonUp="TagSearchBox_Click">

                <TextBlock x:Name="SelectedTagText"
                           Text="タグ選択"
                           Foreground="Black"
                           FontSize="14"
                           VerticalAlignment="Center"
                           TextWrapping="NoWrap"/>
            </Border>

            <Popup x:Name="TagPopup"
                   Placement="Bottom"
                   StaysOpen="False"
                   AllowsTransparency="True"
                   HorizontalOffset="0"
                   VerticalOffset="-10">
                <Border Background="White" 
                        Padding="10"
                        CornerRadius="8"
                        BorderBrush="Black"
                        BorderThickness="1">
                    <ScrollViewer Width="500" Height="500">
                        <!-- タグ一覧 -->
                        <WrapPanel x:Name="TagPanel" />
                    </ScrollViewer>
                </Border>
            </Popup>

        </Grid>

        <!-- ギャラリー本体 -->
        <Grid Grid.Row="2" Grid.ColumnSpan="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="80"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="80"/>
            </Grid.ColumnDefinitions>

            <!-- 左ボタン -->
            <Button Content="◀" Click="PrevPage_Click"
                    Grid.Column="0"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    FontSize="40"/>

            <!-- 中央ギャラリー -->
            <Viewbox Stretch="Uniform" Grid.Column="1">
                <StackPanel>
                    <Grid Width="1000" Height="600">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="37*"/>
                            <ColumnDefinition Width="163*"/>
                        </Grid.ColumnDefinitions>
                        <ItemsControl x:Name="ItemGrid" Margin="15,150,15,5" Grid.ColumnSpan="2">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <UniformGrid Rows="3" Columns="5"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                        </ItemsControl>
                    </Grid>

                    <Label x:Name="PageLabel"
                           HorizontalAlignment="Center"
                           Margin="0,10,0,0"
                           FontSize="20"
                           Content="[1/1]"/>
                </StackPanel>
            </Viewbox>

            <!-- 右ボタン -->
            <Button Content="▶" Click="NextPage_Click"
                    Grid.Column="2"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    FontSize="40"/>
        </Grid>

    </Grid>
</UserControl>
